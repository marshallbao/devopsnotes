### 宿主机安装 replicaSet 副本集

1、下载 mongod-server 安装文件

2、配置文件

```
cat > /etc/mongod.conf <<EOF
systemLog:
  destination: file
  path: /var/log/mongodb/mongodb.log
  logAppend: true
storage:
  journal:
    enabled: true
  dbPath: /data/mongodb
  directoryPerDB: true
  engine: wiredTiger
  wiredTiger:
    engineConfig:
      cacheSizeGB: 1
      directoryForIndexes: true
    collectionConfig:
      blockCompressor: zlib
    indexConfig:
      prefixCompression: true
processManagement:
  fork: true
net:
  bindIp: 0.0.0.0
  port: 27017
security：
  authorization：true
  keyFile：/data/mongodb/mongodb_key
replication:
  oplogSizeMB: 2048
  replSetName: rs0
EOF
```

3、key 文件

```
openssl rand -base64 21 > /data/mongodb/mongodb_key
chmod 600 mongodb_key
```

4、初始化集群

```
>cfg={ _id:"rs0", members:[ {_id:0,host:'10.21.210.78:27517',priority:3}, {_id:1,host:'10.21.210.78:27617',priority:2}, 
{_id:2,host:'10.21.210.78:27717',priority:1}] };
>rs.initiate(cfg)
```

5、创建 root 账号

```
db.createUser({user:"root",pwd:"rootpassword",roles:["root"]})
```













