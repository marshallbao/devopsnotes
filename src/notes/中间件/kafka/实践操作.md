# 实践操作

端口

```
# 9092
客户端连接 broker

# 9093
broker 连接 controller

# 9094
broker 之间的连接

# 9095
EXTERNAL 其他连接
```



常用

```
## 管理主题：kafka-topics.sh

# 列出 topic
kafka-topics.sh --bootstrap-server localhost:9092 --command-config kafka_client_jaas.conf --list

# 创建 topic
kafka-topics.sh --bootstrap-server localhost:9092 --command-config kafka_client_jaas.conf --create --topic test --replication-factor 1 --partitions 1 

# 描述 topic
kafka-topics.sh --bootstrap-server localhost:9092 --command-config kafka_client_jaas.conf --describe --topic test

# 修改 topic
kafka-topics.sh  --command-config kafka_client_jaas.conf  --bootstrap-server localhost:9092   --alter   --topic my-topic   --partitions 2


## 生产消息：kafka-console-producer.sh
kafka-console-producer.sh --bootstrap-server localhost:9092 --producer.config kafka_client_jaas.conf  --topic my-topic


## 消费消息：kafka-console-consumer.sh

# 从头开始消费
kafka-console-consumer.sh --bootstrap-server localhost:9092 --consumer.config kafka_client_jaas.conf --topic my-topic --partition 0 --from-beginning

# 从某个偏移量开始消费
kafka-console-consumer.sh --bootstrap-server localhost:9092 --consumer.config kafka_client_jaas.conf --topic my-topic --partition 0 --offset 1


## 管理消费者组：kafka-consumer-groups.sh


## 管理配置：kafka-configs.sh


## 管理 ACL：kafka-acls.sh


## 控制器
# 控制器的状态
kafka-metadata-quorum.sh --command-config kafka_client_jaas.conf  --bootstrap-server localhost:9092 describe --status
# 控制器的副本
kafka-metadata-quorum.sh --command-config kafka_client_jaas.conf  --bootstrap-server localhost:9092 describe --replication


# 
kafka-metadata-shell.sh --snapshot /bitnami/kafka/data/__cluster_metadata-0/00000000000000000000.log
```



客户端认证文件

```
# cat kafka_client_jaas.conf 
sasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule required username="user1" password="WrxHkfG3jc";
security.protocol=SASL_PLAINTEXT
sasl.mechanism=PLAIN
```



topic 属性

```
# --describe --topic test

kafka-topics.sh  --zookeeper ibr-mw-zookeeper:2181 --describe --topic blocks.wuhan
Topic: blocks.wuhan	PartitionCount: 1	ReplicationFactor: 3	Configs: 
	Topic: blocks.wuhan	Partition: 0	Leader: 1	Replicas: 0,2,1	Isr: 1,2,0


# 第一个行显示所有 partitions 的一个总结，以下每一行给出一个partition中的信息
# 如果我们只有一个 partition ，则只显示一行
# Partition 分区 id
# leader 所有副本中读写副本的 id，每个节点都有可能成为 leader
# replicas 显示给定 partiton 所有副本所存储节点的节点列表，不管该节点是否是leader或者是否存活。
# isr 副本都已同步的的节点集合，这个集合中的所有节点都是存活状态，并且跟leader同步
```



### 参考

https://kafka.apache.org/documentation/#kraft_debug



https://www.cnblogs.com/yeyuzhuanjia/p/18005645

https://www.cnblogs.com/fengjian2016/p/18396008

https://kafka1x.apachecn.org/quickstart.html

https://kafka.apache.org/documentation/#topicconfigs



